---
layout: post
title: "Cloud-native development with the Open Liberty devfile stack and Minikube"
categories: blog
author_picture: https://avatars3.githubusercontent.com/awisniew90
author_github: https://github.com/awiniew90
seo-title: Cloud-native development with the Open Liberty devfile stack and Minikube - OpenLiberty.io
seo-description: Get true-to-production development locally with Minikube.
blog_description: "Get true-to-production development locally with Minikube."
open-graph-image: https://openliberty.io/img/blog/ol-stack-minikube-dash.png
---
= Cloud-native development with the Open Liberty devfile stack and Minikube
Adam Wisniewski <https://github.com/awisniew90>

The Open Liberty devfile stack allows you to develop new and existing cloud-native applications link:https://openliberty.io/blog/2021/01/20/open-liberty-devfile-stack.html[directly in an OpenShift cluster]. But what if you don't have access to a remote cluster? No problem! You can still get all of the benefits of stack development locally with Minikube.

Check out a quick demo:
++++
<iframe width="560" height="315" align="center" src="https://www.youtube.com/embed/KFjVGPyL49Q" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
++++

== Minikube

link:https://minikube.sigs.k8s.io/docs/[Minikube] is Kubernetes running right on your laptop. It's easy to install, fast to start up, and even comes with a web-based dashboard for viewing and managing your deployments. 

== Open Liberty devfile stack

The link:https://github.com/OpenLiberty/application-stack#open-liberty-application-stack[Open Liberty devfile devfile stack] provides much of the tooling and infrastructure you need to start developing your application. Open Liberty, Maven, Open J9, etc. all come packaged in a development image where your app is built and run. A fully configured link:https://docs.devfile.io/devfile/2.0.0/user-guide/index.html[devfile] describes the dev environment and defines all of the build/run commands behind the scenes. You can just sit back and focus on your code. 

== OpenShift Do (odo)

Odo is a simple CLI tool that allows you to create stack projects and interact directly with your Kubernetes cluster (e.g. Minikube). Once you link:https://odo.dev/docs/installing-odo/[install odo], you can start creating Open Liberty stack projects and developing right in Kubernetes.

== Try it out

After link:https://minikube.sigs.k8s.io/docs/start/[installing Minikube], start your local cluster:

[source,sh]
----
$ minikube start
----

MacOS users may need to start Minikube with a driver other than "docker" due to a known issue with the docker driver and the ingress addon. For example: `--driver=virtualbox`

Next, enable the Minikube ingress addon:

[source,sh]
----
$ minikube addons enable ingress
----

This will allow you to create a URL for your app using an ingress domain.

Start the Minikube dashboard (Optional):

[source,sh]
----
$ minikube dashboard
----

Minikube will open a k8s dashboard in your browser. While not necessary, it allows you to view and interact with your cluster and your development pod. 


With Minikube set up, you are now ready to create an Open Liberty stack project. You can either initialize an existing application or use the link:https://github.com/OpenLiberty/application-stack-starters[stack starter] to create a new app. For this blog, we are going to use the link:https://github.com/OpenLiberty/application-stack-intro/tree/blog-demo[application-stack-intro] app. This application is a basic JAX-RS sample that uses Maven, Open Liberty, and MicroProfile.

[source,sh]
----
$ git clone -b blog-demo git@github.com:OpenLiberty/application-stack-intro.git && \
  cd application-stack-intro
----

Create a new namespace in your Minikube cluster:

[source,sh]
----
$ odo project create ol-app-ns
----

Initialize the app as a "java-openliberty" stack project:

[source,sh]
----
$ odo create java-openliberty my-ol-comp
----

You will now see the addition of a `devfile.yaml` file that was downloaded from the default devfile registry. This is the brains behind the Open Liberty devfile stack and defines the development environment for your app. 

Create a URL for the application using an Ingress domain:

For convenience, you can use the link:https://nip.io/[nip.io] service to create mappings of your ingress controller to an external IP. Otherwise, you will need to add the IP to your `etc/hosts` file.

[source,sh]
----
$ odo url create --host $(minikube ip).nip.io
----

Push your app to your local Minikube cluster:

[source,sh]
----
$ odo push
----

Check the output to make sure that your application is up and ready for use:

[source,sh]
----
$ odo log
----

You can look for `CWWKF0011I: The server defaultServer is ready to run a smarter planet` to verify that the server is up. 

To access the application, list the new URL that you created:

[source,sh]
----
$ odo url list

Found the following URLs for component my-ol-comp
NAME                STATE      URL                                              PORT     SECURE     KIND
my-ol-comp-9080     Pushed     http://my-ol-comp-9080.192.168.99.103.nip.io     9080     false      ingress
----

Open a browser to this URL and append `/api/resource` to the end of the URL for the REST endpoint, for example, `http://my-ol-comp-9080.192.168.99.103.nip.io/api/resource`. You should see the following screen:

[.img_border_light]
image::/img/blog/ol-stack-browser-1.png[String response,width=70%,align="center"]

== Start coding!

You are now ready to start coding! After each change to your app, either re-issue `odo push` or simple run `odo watch` to automatically sync your changes with the pod. That's it!

== Learn more

To learn more about odo, go to https://odo.dev.
For more details about the Open Liberty devfile stack, go to https://github.com/OpenLiberty/application-stack.
